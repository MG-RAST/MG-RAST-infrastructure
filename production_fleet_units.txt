
Before starting any fleet units in new cluster, configure etcd:

./production_service_images_in_etcd.sh 


#### production services ####

## mongodb first

fleetctl start mongodb-replica{,-discovery}@1.shock.service
#### manualy set / load primary node before starting update service
# docker exec ${CONTAINER} mongo --quiet -u $USER -p $PASS --eval 'printjson(rs.initiate({_id:"$CHANNEL",members:[{_id:0,host:"${COREOS_PUBLIC_IPV4}:27017"}]}))' admin
fleetctl start mongodb-replica-update@1.shock.service
fleetctl start mongodb-replica{,-discovery,-update}@{2,3}.shock.service
fleetctl start mongodb-replica{,-discovery}@1.awe.service
#### manualy set / load primary node before starting update service
# docker exec ${CONTAINER} mongo --quiet -u $USER -p $PASS --eval 'printjson(rs.initiate({_id:"$CHANNEL",members:[{_id:0,host:"${COREOS_PUBLIC_IPV4}:27017"}]}))' admin
fleetctl start mongodb-replica-update@1.awe.service
fleetctl start mongodb-replica{,-discovery,-update}@{2,3}.awe.service

## mysql / solr / memcache / awe

fleetctl start mysql_metadata{,-backup}@1.service
# fleetctl start mysql_galera_metadata{,-discovery}@{1,2,3}.service
fleetctl start solr-m5nr@1.service
fleetctl start solr-metagenome@1.service
fleetctl start memcached.service # global unit
fleetctl start memcached-discovery.service # global unit / start after above completes
fleetctl start awe-server{,-discovery}@1.service

## confd / nginx

fleetctl start mg-rast-confd.service # global unit
fleetctl start mg-rast-nginx@1.service

## cassandra
## need to manually load data on one seed if starting from scratch

fleetctl start cassandra-seed{,-discovery}@{1,2}.service
fleetctl start cassandra-node@{1,2,3,4,5,6}.service

## api / web

fleetctl start api-server{,-discovery,-update}@{1,2,3}.api.service
fleetctl start mg-rast-v3-web{,-discovery}@{1,2,3,4}.v3-web.service
fleetctl start mg-rast-v4-web{,-discovery}@1.v4-web.service

#### develop services ####

# fleetctl start mg-rast-v3-web{,-discovery}@1.v3-web-dev.service
# fleetctl start api-server{,-discovery,-update}@1.api-dev.service
# fleetctl start cadvisor.service  # global unit
# fleetctl start opscenter@1.service
# fleetctl start fleetui@1.service
